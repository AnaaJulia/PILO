CREATE TABLE localidade (
	`cep` CHAR(9) NOT NULL PRIMARY KEY,
  `logradouro` VARCHAR(45) NOT NULL,
  `bairro` VARCHAR(45) NOT NULL,
  `cidade` VARCHAR(45) NOT NULL,
  `uf` CHAR(2) NOT NULL
);

CREATE TABLE clinica_odonto (
	`id_cli` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
  `cnpj_cli` VARCHAR(18) NOT NULL,
  `nome_cli` VARCHAR(50) NOT NULL,
  `fantasia_cli` VARCHAR(50) NOT NULL,
  `tell_cli` VARCHAR(10) NOT NULL,
  `tell2_cli` VARCHAR(10) NULL,
  `email_cli` VARCHAR(255) NOT NULL,
  `numero_cli` INT NOT NULL,
  `complemento_cli` VARCHAR(45) NOT NULL,
  `cep` CHAR(9) NOT NULL,
  FOREIGN KEY (cep) REFERENCES localidade(cep),
  UNIQUE(cnpj_cli, tell_cli, tell2_cli, email_cli)
);
  
CREATE TABLE lab_protetico (
	`id_lab` INT NOT NULL primary key AUTO_INCREMENT,
  `cnpj_lab` VARCHAR(18) NOT NULL,
  `nome_lab` VARCHAR(50) NOT NULL,
  `fantasia_lab` VARCHAR(50) NOT NULL,
  `tell_lab` VARCHAR(10) NOT NULL,
  `tell2_lab` VARCHAR(10) NULL,
  `email_lab` VARCHAR(255) NOT NULL,
  `numero_lab` INT NOT NULL,
  `complemento_lab` VARCHAR(45) NOT NULL,
  `cep` CHAR(9) NOT NULL,
  FOREIGN KEY (cep) REFERENCES localidade(cep),
  UNIQUE(cnpj_lab, tell_lab, tell2_lab, email_lab)
);

CREATE TABLE tecnologias (
	`id_tec` INT NOT NULL PRIMARY KEY  AUTO_INCREMENT,
  `nome_tec` VARCHAR(45) NOT NULL,
  `desc_tec` VARCHAR(100) NOT NULL
);

CREATE TABLE habilitado (
	`id_lab` INT NOT NULL,
   `id_tec` INT NOT NULL,
   FOREIGN KEY (id_tec) REFERENCES tecnologias(id_tec),
   FOREIGN KEY (id_lab) REFERENCES lab_protetico(id_lab)
);

CREATE TABLE user_cli (
	`iduser_cli` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
  `nome_usercli` VARCHAR(45) NOT NULL,
  `email_usercli` VARCHAR(255) NOT NULL,
  `cpf_usercli` VARCHAR(14) NOT NULL,
  `nivel_usercli` INT NOT NULL,
  `id_cli` INT NOT NULL,
   FOREIGN KEY (id_cli) REFERENCES clinica_odonto(id_cli),
   UNIQUE(email_usercli, cpf_usercli)
);

CREATE TABLE user_lab (
	`iduser_lab` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
  `nome_userlab` VARCHAR(45) NOT NULL,
  `email_userlab` VARCHAR(255) NOT NULL,
  `cpf_userlab` VARCHAR(14) NOT NULL,
  `nivel_userlab` INT NOT NULL,
  `id_lab` INT NOT NULL,
  FOREIGN KEY (id_lab) REFERENCES lab_protetico(id_lab),
  UNIQUE(email_userlab, cpf_userlab)
);

CREATE TABLE avaliacao (
	`id_avaliacao` INT NOT NULL PRIMARY key AUTO_INCREMENT,
  `nota_avaliacao` INT NOT NULL,
  `desc_avaliacao` VARCHAR(255) NOT NULL,
  `iduser_cli` INT NOT NULL,
  `iduser_lab` INT NOT NULL,
  FOREIGN KEY (iduser_cli) REFERENCES user_cli(iduser_cli),
  FOREIGN KEY (iduser_lab) REFERENCES user_lab(iduser_lab)
);

CREATE TABLE paciente (
	`id_paciente` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
  `nome_paciente` VARCHAR(45) NOT NULL,
  `tell_paciente` VARCHAR(10) NOT NULL,
  `cpf_paciente` VARCHAR(14) NOT NULL,
  `email_paciente` VARCHAR(255) NOT NULL,
  UNIQUE(tell_paciente, cpf_paciente, email_paciente)
);

CREATE TABLE dentista (
	`id_dentista` INT NOT NULL PRIMARY key AUTO_INCREMENT,
  `nome_dentista` VARCHAR(45) NOT NULL,
  `tell_dentista` VARCHAR(10) NOT NULL,
  `cpf_dentista` VARCHAR(14) NOT NULL,
  `email_dentista` VARCHAR(255) NOT NULL,
  `cro_dentista` VARCHAR(45) NOT NULL,
  UNIQUE(tell_dentista, cpf_dentista, email_dentista, cro_dentista)
);

CREATE TABLE servico(
	`id_servico` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
  `nome_serv` VARCHAR(45) NOT NULL,
  `data_serv` DATE NOT NULL,
  `status_serv` VARCHAR(45) NOT NULL,
  `situacao_serv` VARCHAR(45) NOT NULL,
  `orcamento_serv` REAL NOT NULL,
  `valor_serv` REAL NOT NULL,
  `valor_acrescimo` REAL NOT NULL,
  `valor_desconto` REAL NOT NULL,
  `taxa_entrega` REAL NOT NULL,
  `obs` VARCHAR(255) NOT NULL,
  `iduser_cli` INT NOT NULL,
  `iduser_lab` INT NOT NULL,
  `id_paciente` INT NOT NULL,
  `id_dentista` INT NOT NULL,
  FOREIGN KEY (iduser_cli) REFERENCES user_cli(iduser_cli),
  FOREIGN KEY (iduser_lab) REFERENCES user_lab(iduser_lab),
  FOREIGN KEY (id_paciente) REFERENCES paciente(id_paciente),
  FOREIGN KEY (id_dentista) REFERENCES dentista(id_dentista)
);